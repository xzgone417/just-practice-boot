<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.exp.ucmp.partner.dao.SysPartnerStaffInfoDao">

    <resultMap id="sysParentUserInfoResultMap" type="com.exp.ucmp.store.dto.SysPartnerStaffInfoDto">
        <result column="party_id" property="partyId" jdbcType="INTEGER"/>
        <result column="partner_staff_name" property="partnerStaffName" jdbcType="VARCHAR"/>
        <result column="partner_staff_iphone" property="partnerStaffIphone" jdbcType="VARCHAR"/>
        <result column="partner_staff_sex" property="partnerStaffSex" jdbcType="INTEGER"/>
        <result column="partner_staff_email" property="partnerStaffEmail" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="sysPartnerStaffInfoColumnList">
            party_id,
            partner_staff_name,
            partner_staff_iphone,
            partner_staff_sex,
            partner_staff_email
    </sql>

    <select id="selectPartnerStaffInfoByStoreId"  resultType="com.exp.ucmp.store.dto.SysPartnerStaffInfoDto">
        SELECT
        ssr.rela_id AS partyId,
        pd.partner_code AS partnerCode,
        pd.partner_name AS partnerName,
        ssi.partner_staff_name AS partnerStaffName,
        ssi.partner_staff_iphone AS partnerStaffIphone,
        ssi.partner_staff_sex AS partnerStaffSex,
        ssi.partner_staff_email AS partnerStaffEmail,
        ssr.is_enable AS isEnable
        FROM
        t_sys_partner_staff_store_rela ssr
        LEFT JOIN t_sys_partner_staff_info ssi ON ssr.party_id = ssi.party_id
        LEFT JOIN t_sys_partner_details pd ON ssr.partner_id = pd.partner_id
        <where>
            ssr.store_id = #{storeId}
         AND
            ssi.is_delete ='00'
         AND
            pd.partner_status ='01'
        </where>
    </select>


    <select id="findPartnerDetailsByStoreId"  resultType="com.exp.ucmp.pertner.dto.SysPartnerDetailsDto">
        SELECT
        ssr.rela_id  AS partnerId,
        spd.partner_code  AS partnerCode,
        spd.partner_name AS partnerName,
        spd.partner_join_role  AS partnerJoinRole,
        ssr.is_enable  AS partnerStatus
        FROM
        t_sys_store_partner_rela ssr
        LEFT JOIN
          t_sys_partner_details spd
        ON
          ssr.partner_id = spd.partner_id
        <where>
            ssr.store_id = #{storeId}
        AND
            spd.is_delete='0'
        AND
            spd.partner_status ='01'
        </where>
    </select>

</mapper>